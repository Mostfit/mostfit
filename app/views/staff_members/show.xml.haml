%xml
  %staff_member
    %id #{@staff_member.id}
    %name #{@staff_member.name}
    %mobile_number #{@staff_member.mobile_number}
    %creation_date #{@staff_member.creation_date}
    %active #{@staff_member.active}
    %user_id #{@staff_member.user_id}
    - if @option == "regions" and not @staff_member.regions.blank?
      %regions
        - @staff_member.regions.each do |region|
          = region.to_xml
    - elsif @option == "areas" and not @staff_member.areas.blank?
      %areas
        - @staff_member.areas.each do |area|
          = area.to_xml
    - elsif @option == "branches" and not @staff_member.branches.blank?
      %branches
        - @staff_member.branches.each do |branche|
          = branche.to_xml
    - elsif @option == "centers" and not @staff_member.centers.blank?
      %centers
        - @staff_member.centers.each do |center|
          = center.to_xml
    - elsif @option == "clients" and not @staff_member.clients.blank?
      %clients
        - @staff_member.clients.each do |client|
          %client
            %id #{client.id}
            %name #{client.name}
            %reference #{client.reference}
            %date_of_birth #{client.date_of_birth}
            %spouse_name #{client.spouse_name}
            %address #{h(client.address)}
            %active #{client.active}
            %date_joined #{client.date_joined}
            %client_group_id #{client.client_group_id}
            %center_id #{client.center_id}
            - if client.loans
              %loans
                - client.loans.each do |loan|
                  %loan
                    %id #{loan.id}
                    %amount #{loan.amount}
                    %interest_rate #{loan.interest_rate}
                    %installment_frequency #{loan.installment_frequency}
                    %number_of_installments #{loan.number_of_installments}
                    %client_id #{loan.client_id}
                    %applied_on #{loan.applied_on}
                    %approved_on #{loan.approved_on}
                    %disbursal_date #{loan.disbursal_date}
                    %loan_product_id #{loan.loan_product_id}
                    %applied_by_staff_id #{loan.applied_by_staff_id}
                    %disbursed_by_staff_id #{loan.disbursed_by_staff_id}
    - elsif @option == "full"
      - if not @staff_member.regions.blank?
        %regions
          - @staff_member.regions.each do |region|
            = region.to_xml
      - if not @staff_member.areas.blank?
        %areas
          - @staff_member.areas.each do |area|
            = area.to_xml
      - if not @staff_member.branches.blank?
        %branches
          - @staff_member.branches.each do |branche|
            = branche.to_xml
      - if not @staff_member.centers.blank?
        %centers
          - @staff_member.centers.each do |center|
            = center.to_xml
      - if not @staff_member.clients.blank?
        %clients
          - @staff_member.clients.each do |client|
            %client
              %id #{client.id}
              %name #{client.name}
              %reference #{client.reference}
              %date_of_birth #{client.date_of_birth}
              %spouse_name #{client.spouse_name}
              %address #{h(client.address)}
              %active #{client.active}
              %date_joined #{client.date_joined}
              %client_group_id #{client.client_group_id}
              %center_id #{client.center_id}
              - if client.loans
                %loans
                  - client.loans.each do |loan|
                    %loan
                      %id #{loan.id}
                      %amount #{loan.amount}
                      %interest_rate #{loan.interest_rate}
                      %installment_frequency #{loan.installment_frequency}
                      %number_of_installments #{loan.number_of_installments}
                      %client_id #{loan.client_id}
                      %applied_on #{loan.applied_on}
                      %approved_on #{loan.approved_on}
                      %disbursal_date #{loan.disbursal_date}
                      %loan_product_id #{loan.loan_product_id}
                      %applied_by_staff_id #{loan.applied_by_staff_id}
                      %disbursed_by_staff_id #{loan.disbursed_by_staff_id}
